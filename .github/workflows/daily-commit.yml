name: Daily Auto-Commit

on:
  # اجرا هر روز ساعت ۰۰:۰۰ UTC
  schedule:
    - cron: '0 0 * * *'
  # امکان اجرای دستی برای تست
  workflow_dispatch:

jobs:
  auto_commit:
    runs-on: ubuntu-latest
    
    # این بخش بسیار مهم است: به ربات اجازه می‌دهد تا فایل‌ها را تغییر دهد
    permissions:
      contents: write
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Update README with current date/time
        # استفاده از علامت | باعث می‌شود کاراکترهای خاص باعث ارور نشوند
        run: |
          echo "Last automated activity on: $(date)" >> README.md
          
      - name: Configure Git
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'
          
      - name: Commit and Push changes
        run: |
          git add README.md
          # اگر تغییری نبود، ارور نده و ادامه بده
          git diff-index --quiet HEAD || git commit -m "Automated daily activity: $(date +%Y-%m-%d)"
          git push
